---
title: Rustの開発環境の構築（MacOS）
description: Rustの開発に必要なRustツールチェーンをインストールして使用できるようにするまでの備忘録
createdAt: 2023-01-25
# updatedAt:
tags: [Rust]
---

# 目次

# Rustの開発環境の構築
- Rustの開発には、**Rustツールチェーンが必要**
  - （バイナリを実行する環境には不要）
- **rustupで、Rustツールチェーンをインストール・管理**
  - 直接、Rustツールチェーンをダウンロードできるが非推奨
- **rustup-init（インストーラー）で、Rustツールチェーンとrustupをインストールできる**

※ツールチェーンとは、一般にプログラム開発に使う一連の道具のこと。rustupも広義にはツールチェーンと言えるが、厳密に考えても仕方がない。

---

- **Rustツールチェーン：**
  - 構成
    - **rustc：**
      - Rustのコンパイラ
    - **Cargo（カーゴ）：**
      - Rustのパッケージマネージャー
      - **（Node.jsでいうところのnpm）**
    - **std：**
      - Rustの標準ライブラリ
  - 種類（リリースチャンネル）
    - stable（安定版）
    - beta（ベータ版）
    - nightly（開発版）
- **rustup：**
  - Rustツールチェーンのインストール
  - Rustツールチェーンの複数バージョン管理
  - クロスコンパイル用ターゲットのインストール
  - 開発支援ツールのインストール
  - **（Node.jsでいうところのnvm や nodenv）**
  - [rustupの公式ドキュメント](https://rust-lang.github.io/rustup/)

## Rustツールチェーンのインストール

- **rustup-init（インストーラー）のインストール方法：**
  - **①インストールコマンド**
　or
  - **②Homebrew**<br />
```bash
# ①インストールコマンド でインストール
% curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

---

ヌギーは②brewでインストール
```bash
# ②Homebrew でインストール
% brew install rustup-init
```

## 実際にrustup-init（インストーラー）を実行（セットアップ）
rustup-initで、Rustツールチェーンをインストールしていく。

**rustup-initコマンドでセットアップ開始！**（されない場合は、ターミナルを再起動しましょう）
```bash
% rustup-init
```

しかし、ヌギーの環境ではすでにRustがインストールされており、警告⚠️が出てしまいました。
```bash
warning: it looks like you have an existing installation of Rust at:
warning: /opt/homebrew/bin
warning: It is recommended that rustup be the primary Rust installation.
warning: Otherwise you may have confusion unless you are careful with your PATH
warning: If you are sure that you want both rustup and your already installed Rust
warning: then please reply `y' or `yes' or set RUSTUP_INIT_SKIP_PATH_CHECK to yes
warning: or pass `-y' to ignore all ignorable checks.
error: cannot install while Rust is installed
```
> /opt/homebrew/binにRustがインストールされているようです。
> Rustのインストールはrustupを優先することをお勧めします。
> そうでないと、PATH に注意しないと混乱する可能性があります。
> もし、rustup と既にインストールされている Rust の両方が必要なのであれば、`y` か `yes` と答えるか、RUSTUP_INIT_SKIP_PATH_CHECK を yes に設定するか、`-y` を渡して無視できるチェックをすべて無視してください。

↑一旦無視して、**Continue? (y/N)**と出るので脳死で**yes**すると**Welcome to Rust**と歓迎され、続きます↓<br />
（※後でスタッフが**brew uninstall rust**しました）

```bash
# 続き
Welcome to Rust!

〜省略〜

This path will then be added to your PATH environment variable by
modifying the profile files located at:

  /Users/user/.profile
  /Users/user/.zshenv

〜省略〜

1) Proceed with installation (default)
2) Customize installation
3) Cancel installation
> // エンター（1以外を選ぶ場合は2または3と入力してからエンター）
```
↑この3択は環境構築の方法ですが、とりあえずヌギーはdefaultの「1」にするため、エンターを押しました。

このとき、**「/Users/user/.profile」と「/Users/user/.zshenv」がないとエラー**になるので、**無い場合は空ファイルでいいので作成**しましょう（人によってはこのファイルは異なるかもしれません）。

```bash
# 続き
info: profile set to 'default'

〜省略〜

Rust is installed now. Great!

To get started you may need to restart your current shell.
This would reload your PATH environment variable to include
Cargo's bin directory ($HOME/.cargo/bin).

To configure your current shell, run:
source "$HOME/.cargo/env"
```
↑と出るので、指示どおり「.cargo/env」を読み込み直し、パスを反映↓
```bash
% source "$HOME/.cargo/env"
```

- 「.cargo/env」ファイルは、単に「$HOME/.cargo/bin」のパスを通しているだけ
- 「$HOME/.cargo/bin」ディレクトリにrustc、cargo、rustupコマンドが格納されている

これでRustの開発で使用するコマンドが叩けるはずです↓
```bash
# cargo のバージョン確認
cargo --version
# rustc のバージョン確認
rustc --version
# rustdoc のバージョン確認
rustdoc --version
# rustup のバージョン確認
rustup --version
```

# 参考
  - [Rust をインストール（公式）](https://www.rust-lang.org/ja/tools/install)
  - [macOSでRustのローカル開発環境を整えるための手順2022](https://qiita.com/notakaos/items/9f3ee8a3f3a0caf39f7b)
  - [MacでRustの開発環境を構築する](https://qiita.com/maoutokagura/items/c2fd85132bcec399c3a1)
  - [【Rust 入門】macOS と VSCode で環境構築をする方法](https://zenn.dev/shogo_wada_pro/articles/365e2710a44f5a)
  - [実践Rustプログラミング入門](https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5Rust%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%85%A5%E9%96%80-%E5%88%9D%E7%94%B0-%E7%9B%B4%E4%B9%9F/dp/4798061700)
  - [実践Rust入門[言語仕様から開発手法まで]](https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5Rust%E5%85%A5%E9%96%80-%E8%A8%80%E8%AA%9E%E4%BB%95%E6%A7%98%E3%81%8B%E3%82%89%E9%96%8B%E7%99%BA%E6%89%8B%E6%B3%95%E3%81%BE%E3%81%A7-%CE%BAeen/dp/4297105594)
